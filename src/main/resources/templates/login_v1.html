<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>congnition</title>
    <meta name="keywords" content="CarManger管理系统">
    <meta name="description" content="CarManger管理系统">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/font-awesome.css">
    <link rel="stylesheet" href="/css/animate.css">
    <link rel="stylesheet" href="/css/login_v1.css">
    <link rel="stylesheet" href="/css/layui.css">
</head>

<body>
<!--登陆界面-->
<div class="signinpanel">
    <form>
        <h3 class="text-center">用户登录</h3><br/>
        <p class="m-t-md text-center">欢迎登录cognition</p>

        <input type="text" name="loginInfo" class="form-control uname" placeholder="请输入手机号\邮箱"/>

        <input type="password" name="password" class="form-control pword m-b" placeholder="请输入密码"/>

        <div class="row">
            <div class="col-xs-12 pull_left">
                <div class="form-group">
                    <input class="form-control" type="tel" name="verify" id="verify"
                           placeholder="请输入验证码" maxlength="4">
                </div>
                <a href="javascript:void(0);" rel="external nofollow" class="layoutVerification" title="点击更换验证码">
                    <!--height="36" width="100%" style="margin-top: 12px;"-->
                    <img id="imgVerify" src="" alt="更换验证码" onclick="getVerify(this);">
                </a>
            </div>
        </div>
        <a id="login" class="btn btn-login btn-block">登录</a>
    </form>
    <div style="padding:10px;text-align:right;">
        <a href="/toRegister" style="color: #0d8ddb">立即注册>></a>
    </div>

    <div class="signup-footer">
        <!--© 2019 xxx.com  京ICP备 12003892号-11 XXXXX有限公司-->
        <div class="pull-left">&copy; 2019 cognition.com 冀ICP备19019505号-1 carManger车辆管理平台</div>
    </div>
</div>

<!-- 全局js -->
<script type="text/javascript" src="/js/jquery.min.js?v=2.1.4"></script>
<script type="text/javascript" src="/js/bootstrap.min.js?v=3.3.6"></script>
<!-- 自定义js -->
<script type="text/javascript" src="/js/content.js?v=1.0.0"></script>

<!-- jQuery Validation plugin javascript-->
<script type="text/javascript" src="/js/ajax-util.js"></script>
<script type="text/javascript" src="/js/plugins/validate/jquery.validate.min.js"></script>
<script type="text/javascript" src="/js/plugins/validate/messages_zh.min.js"></script>
<script type="text/javascript" src="/js/layui.all.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#login").on('click', function () {
            $("#signupForm").submit();
        });
        validateRule();
        $("body").keydown(keyDownLogon);
        // getVerify($("#imgVerify"));
        $("#imgVerify").click()
    });


    $.validator.setDefaults({
        submitHandler: function () {
            login();
        }
    });


    //登陆接口调用
    function login() {
        $.ajax({
            type: "POST",
            url: "/login",
            data: $('#signupForm').serialize(),
            success: function (response) {
                if (response.state == 0) {
                    parent.layer.close(parent.index);
                    parent.location.reload();
                } else {
                    layer.msg(response.msg);
                }
            }
        });
    }

    //监听按键按下
    function keyDownLogon() {
        if (event.keyCode == "13") {
            $("#login").trigger('click');
        }
    }


    function validateRule() {
        var icon = "<i class='fa fa-times-circle'></i> ";
        $("#signupForm").validate({
            rules: {
                loginInfo: {
                    required: true
                },
                password: {
                    required: true
                }
            },
            messages: {
                loginInfo: {
                    required: icon + "请输入您的用户名或账户信息"
                },
                password: {
                    required: icon + "请输入您的密码"
                }
            }
        })
    }

    //获取验证码
    function getVerify(obj) {
        obj.src = "/getVerify?" + Math.random();
    }
</script>
</body>
</html>
